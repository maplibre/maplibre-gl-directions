For the sakes of your convenience, make sure you've enabled the "Public/Protected" filter:

![Enabling the "Public/Protected" filter](https://raw.githubusercontent.com/maplibre/maplibre-gl-directions/main/doc/images/public-protected-filter.png)

In short, all the plugin's customization possibilities fall down into 2 categories: visual-only customization and behavioral customization.

## Visual-only customization

Visual-only customization is done by modifying the style layers used by the plugin. You can either remove certain layers altogether, or instead add additional custom ones, or modify existing layers, or refuse from using or modifying the existing layers and instead define new layers from scratch. Or you can combine these different approaches to achieve the look-and-feel you aim towards.

When you create an instance of Directions, you're allowed to provide the constructor with the {@link MapLibreGlDirectionsConfiguration|configuration object}. One of the configuration fields is the {@link layers|`layers`} array.

By default (if you don't provide this configuration option), the plugin uses the default layers that are generated by the {@link layersFactory|`layersFactory`} function. But you can instead provide a plain array of {@link LayerSpecification} objects. See the "Restyling" example for details.

When re-defining the layers, you must respect the following rules:

1. There must be at least one layer for Waypoints
2. There must be at least one layer for Snappoints
3. There must be at least one layer for the Hoverpoint
4. There must be at least one layer for Routelines
5. There must be at least one layer for Alternative Routelines

Waypoints, Snappoints and the Hoverpoint represent (obviously enough) Point GeoJSON Features. So you would most probably like to use either "symbol" or "circle" layer types for those.

Routelines and Alternative Routelines represent GeoJSON LineString Features and therefore must be represented with layers of type "line".

You can also optionally provide one or more layers for the snaplines (the lines that connect Waypoints to their related snappoints and the Hoverpoint to its related Waypoints).

To filter out the features that are only applicable for the given layers, you can use the following filters:

1. For Snaplines: `["==", ["get", "type"], "SNAPLINE"]` (meaning: all the features where `feature.properties.type === "SNAPLINE"`)
2. For Alternative Routelines: `["==", ["get", "route"], "ALT"]` (meaning: all the features where `feature.properties.type === "ALT"`)
3. For Routelines (i.e. the selected Routeline): `["==", ["get", "route"], "SELECTED"]` (meaning: all the features where `feature.properties.type === "SELECTED"`)
4. For the Hoverpoint: `["==", ["get", "type"], "HOVERPOINT"]` (meaning: all the features where `feature.properties.type === "HOVERPOINT"`)
5. For Snappoints: `["==", ["get", "type"], "SNAPPOINT"]` (meaning: all the features where `feature.properties.type === "SNAPPOINT"`)
6. For Waypoints: `["==", ["get", "type"], "WAYPOINT"]` (meaning: all the features where `feature.properties.type === "WAYPOINT"`)

Note that the order the layers appear in the array determines the order the features will appear on the map. You are free to use any order that applies better for your exact case, but by default the layers come in the order they're listed above: the Waypoints' layers are the foremost ones.

Here's the example of the layers re-definition for the "Restyling" example:

```typescript
layers: [
  {
    id: "maplibre-gl-directions-snapline",
    type: "line",
    source: "maplibre-gl-directions",
    layout: {
      "line-cap": "round",
      "line-join": "round",
    },
    paint: {
      "line-dasharray": [2, 2],
      "line-color": "#ffffff",
      "line-opacity": 0.65,
      "line-width": 2,
    },
    filter: ["==", ["get", "type"], "SNAPLINE"],
  },

  {
    id: "maplibre-gl-directions-alt-routeline",
    type: "line",
    source: "maplibre-gl-directions",
    layout: {
      "line-cap": "butt",
      "line-join": "round",
    },
    paint: {
      "line-pattern": "routeline",
      "line-width": 8,
      "line-opacity": 0.5,
    },
    filter: ["==", ["get", "route"], "ALT"],
  },

  {
    id: "maplibre-gl-directions-routeline",
    type: "line",
    source: "maplibre-gl-directions",
    layout: {
      "line-cap": "butt",
      "line-join": "round",
    },
    paint: {
      "line-pattern": "routeline",
      "line-width": 8,
    },
    filter: ["==", ["get", "route"], "SELECTED"],
  },

  {
    id: "maplibre-gl-directions-hoverpoint",
    type: "symbol",
    source: "maplibre-gl-directions",
    layout: {
      "icon-image": "balloon-hoverpoint",
      "icon-anchor": "bottom",
      "icon-ignore-placement": true,
      "icon-overlap": "always",
    },
    filter: ["==", ["get", "type"], "HOVERPOINT"],
  },

  {
    id: "maplibre-gl-directions-snappoint",
    type: "symbol",
    source: "maplibre-gl-directions",
    layout: {
      "icon-image": "balloon-snappoint",
      "icon-anchor": "bottom",
      "icon-ignore-placement": true,
      "icon-overlap": "always",
    },
    filter: ["==", ["get", "type"], "SNAPPOINT"],
  },

  {
    id: "maplibre-gl-directions-waypoint",
    type: "symbol",
    source: "maplibre-gl-directions",
    layout: {
      "icon-image": "balloon-waypoint",
      "icon-anchor": "bottom",
      "icon-ignore-placement": true,
      "icon-overlap": "always",
    },
    filter: ["==", ["get", "type"], "WAYPOINT"],
  },
];
```

As you can see, each layer type is represented by one layer: one for Snaplines, one for the Hoverpoint and so on. But you're not restricted to one layer-per-feature. Each feature could easily be represented by multiple layers. By the way, that's exactly the way the things are implemented by default. E.g. each Waypoint is by default represented by 2 layers: one for the casing ("halo", as the MapLibre's spec calls it) and one for the main, central circle.

By default, the plugin expects you to provide casings for Waypoints, Snappoints, Hoverpoint, and all the Routelines (though the Hoverpoint's casing is not interactive). The thing here is that all these features are interactive (when the interactivity is enabled) and the user would probably like to be able not to aim exactly at the very center of a Waypoint to be able to move it. Here comes the concept of sensitive layers.

If you decide to deviate from the default model where there are 2 layers for Waypoints, 2 layers for Snappoints, 2 layers for Routelines and 2 layers for Alternative Routelines, you must manually specify which layers should be considered sensitive for each group of these features. Please, see the "Restyling" example for details. Namely, take a look at the source code for the example.

Originally, the definitions of the sensitive layers look like these:

1. `sensitiveWaypointLayers: ["maplibre-gl-directions-waypoint", "maplibre-gl-directions-waypoint-casing"]`
2. `sensitiveSnappointLayers: ["maplibre-gl-directions-snappoint", "maplibre-gl-directions-snappoint-casing"]`
3. `sensitiveRoutelineLayers: ["maplibre-gl-directions-routeline", "maplibre-gl-directions-routeline-casing"]`
4. `sensitiveAltRoutelineLayers: ["maplibre-gl-directions-alt-routeline", "maplibre-gl-directions-alt-routeline-casing"]`

If you, e.g., decide to use the only `"my-waypoint"` layer to represent all the Waypoints, you must update the `sensitiveWaypointLayers` option's value respectfully: `sensitiveWaypointLayers: ["my-waypoint"]`.

Also, don't forget to make sure that all the custom icons and images you use for your custom layers are loaded and added to the map beforehand.

Another example of your interest might be the "Show Routes' Directions" one. It doesn't add any additional layers, but instead modifies one default layer (the one for the Routelines) to add arrows that show the direction in which the route follows.

## Behavioral customization

WIP on subclasses (and events?)
Consider 2 scenarios: load-save and distance-measurement.
